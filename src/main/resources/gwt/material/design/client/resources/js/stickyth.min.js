!function(e,t,i){"use strict";function o(i,o){var s=this;s.$el=e(i),s.el=i,s.id=n++,s.$window=e(t),s.$document=e(document),s.$el.bind("destroyed",e.proxy(s.teardown,s)),s.$clonedHeader=null,s.$originalHeader=null,s.isSticky=!1,s.hasBeenSticky=!1,s.leftOffset=null,s.topOffset=null,s.scrollBarWidth=13,s.init=function(){s.$el.each(function(){var t=e(this);s.scrollBarWidth=e.scrollBarWidth(),t.css("padding",0),s.$originalHeader=e("thead:first",this),s.$clonedHeader=s.$originalHeader.clone(),t.trigger("clonedHeader."+l,[s.$clonedHeader]),s.$clonedHeader.addClass("tableFloatingHeader"),s.$clonedHeader.css("display","none"),s.$originalHeader.addClass("tableFloatingHeaderOriginal"),s.$originalHeader.after(s.$clonedHeader),s.$printStyle=e('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),e("head").append(s.$printStyle)}),s.setOptions(o),s.updateWidth(),s.toggleHeaders(),s.bind()},s.destroy=function(){s.$el.unbind("destroyed",s.teardown),s.teardown()},s.teardown=function(){s.isSticky&&s.$originalHeader.css("position","static"),e.removeData(s.el,"plugin_"+l),s.unbind(),s.$clonedHeader.remove(),s.$originalHeader.removeClass("tableFloatingHeaderOriginal"),s.$originalHeader.css("visibility","visible"),s.$printStyle.remove(),s.el=null,s.$el=null},s.bind=function(){s.$scrollableArea.on("scroll."+l,s.toggleHeaders),s.isWindowScrolling||(s.$window.on("scroll."+l+s.id,s.setPositionValues),s.$window.on("resize."+l+s.id,s.toggleHeaders)),s.$scrollableArea.on("resize."+l,s.toggleHeaders),s.$scrollableArea.on("resize."+l,s.updateWidth),s.$window.on("resize."+l,s.updateWidth),s.detectOuterScrolls()},s.unbind=function(){s.$scrollableArea.off("."+l,s.toggleHeaders),s.isWindowScrolling||(s.$window.off("."+l+s.id,s.setPositionValues),s.$window.off("."+l+s.id,s.toggleHeaders)),s.$scrollableArea.off("."+l,s.updateWidth),s.$window.off("."+l+s.id,s.updateWidth),s.$scrollableArea.parents().each(function(t,i){e(this).off("."+l)})},s.detectOuterScrolls=function(){s.$scrollableArea.parents().each(function(t,i){var o=e(this);o.off("."+l),o.hasScrollBar()&&o.on("scroll."+l,s.toggleHeaders)})},s.toggleHeaders=function(){s.$el&&s.$el.each(function(){var t,i=e(this),o=s.isWindowScrolling?isNaN(s.options.fixedOffset)?s.options.fixedOffset.outerHeight():s.options.fixedOffset:s.$scrollableArea.offset().top+(isNaN(s.options.fixedOffset)?0:s.options.fixedOffset),l=i.offset(),n=s.$scrollableArea.scrollTop()+o,r=(s.$scrollableArea.scrollLeft(),s.isWindowScrolling?n>l.top:o>l.top);(s.isWindowScrolling?n:0)<l.top+i.height()-s.$clonedHeader.height()-(s.isWindowScrolling?0:o);r?(t=l.left+s.options.leftOffset,s.$originalHeader.css({position:"fixed","margin-top":s.options.marginTop,left:t,"z-index":3}),s.leftOffset=t,s.topOffset=o,s.$clonedHeader.css("display",""),s.isSticky||(s.isSticky=!0,s.updateWidth(),s.$el.trigger("sticky-change",[!0])),s.setPositionValues()):s.isSticky&&(s.$originalHeader.css("position","static"),s.$clonedHeader.css("display","none"),s.isSticky=!1,s.resetWidths(e("td,th",s.$clonedHeader),e("td,th",s.$originalHeader)),s.$el.trigger("sticky-change",[!1]))})},s.setPositionValues=function(){var e=s.$window.scrollTop(),t=s.$window.scrollLeft();if(!(!s.isSticky||0>t||t+s.$window.width()>s.$document.width())){s.detectOuterScrolls();var i=s.$scrollableArea.scrollLeft(),o=s.$scrollableArea.scrollLeft()+s.getOuterScrollLeft(),l=(s.getOuterScrollTop()-s.options.marginTop,s.$originalHeader.outerHeight());s.$originalHeader.css({top:s.topOffset-(s.isWindowScrolling?0:e),left:s.leftOffset-(s.isWindowScrolling?0:t),clip:"rect(0px, "+(s.$scrollableArea.outerWidth()+i-s.scrollBarWidth)+"px, "+(l+50)+"px, "+o+"px)"})}},s.updateWidth=function(){if(s.isSticky){s.$originalHeaderCells||(s.$originalHeaderCells=e("th,td",s.$originalHeader)),s.$clonedHeaderCells||(s.$clonedHeaderCells=e("th,td",s.$clonedHeader));var t=s.getWidths(s.$clonedHeaderCells);s.setWidths(t,s.$clonedHeaderCells,s.$originalHeaderCells),s.$originalHeader.css("width",s.$clonedHeader.width())}},s.getWidths=function(i){var o=[];return i.each(function(i){var l,n=e(this);if("border-box"===n.css("box-sizing"))l=n[0].getBoundingClientRect().width;else{var r=e("th",s.$originalHeader);if("collapse"===r.css("border-collapse"))if(t.getComputedStyle)l=parseFloat(t.getComputedStyle(this,null).width);else{var a=parseFloat(n.css("padding-left")),d=parseFloat(n.css("padding-right")),c=parseFloat(n.css("border-width"));l=n.outerWidth()-a-d-c}else l=n.width()}o[i]=l}),o},s.setWidths=function(e,t,i){t.each(function(t){var o=e[t];i.eq(t).css({"min-width":o,"max-width":o})})},s.resetWidths=function(t,i){t.each(function(t){var o=e(this);i.eq(t).css({"min-width":o.css("min-width"),"max-width":o.css("max-width")})})},s.getOuterScrollTop=function(){var t=0;return s.$scrollableArea.parents(":not(body)").each(function(){t+=e(this).scrollTop()}),t},s.getOuterScrollLeft=function(){var t=0;return s.$scrollableArea.parents(":not(body)").each(function(){t+=e(this).scrollLeft()}),t},s.setOptions=function(i){s.options=e.extend({},r,i),s.$scrollableArea=e(s.options.scrollableArea),s.isWindowScrolling=s.$scrollableArea[0]===t},s.updateOptions=function(e){s.setOptions(e),s.unbind(),s.bind(),s.updateWidth(),s.toggleHeaders()},s.init()}var l="stickyTableHeaders",n=0,r={fixedOffset:0,leftOffset:0,marginTop:0,scrollableArea:t};e.fn[l]=function(t){return this.each(function(){var i=e.data(this,"plugin_"+l);i?"string"==typeof t?i[t].apply(i):i.updateOptions(t):"destroy"!==t&&e.data(this,"plugin_"+l,new o(this,t))})}}(jQuery,window);
